<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>è¥¿è¥¿é‡Œå³¶ Pizza é»é¤ç³»çµ±</title>
  <link rel="icon" href="data:,">
  <style>
    body { font-family: sans-serif; padding: 20px; background: #fff9f2; }
    h1 { color: #d33; }
    .menu { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
    .item { border: 1px solid #ccc; padding: 10px; border-radius: 10px; background: #fff; }
    .order-list { margin-top: 20px; border-top: 2px solid #333; padding-top: 10px; }
  </style>
</head>
<body>

<h1>è¥¿è¥¿é‡Œå³¶ Pizza é»é¤</h1>

<div class="menu" id="menu-list"></div>

<label>
  ğŸ“ å®¢æˆ¶é›»è©±ï¼š
  <input type="text" id="customer-phone" placeholder="è¼¸å…¥é›»è©±æˆ–å‚™è¨»">
</label>

<div class="order-list" id="order-summary">
  <h2>ğŸ§¾ è¨‚å–®æ¸…å–®</h2>
  <ul id="order-items"></ul>
  <p><strong>ç¸½é‡‘é¡ï¼š</strong><span id="total-price">0</span> å…ƒ</p>
  <button onclick="submitOrder()">âœ… é€å‡ºè¨‚å–®</button>
</div>

<script>
const menuItems = [
  { name: "ç‘ªæ ¼éº—ç‰¹", price: 250 },
  { name: "é„‰é‡æ™‚è”¬", price: 250 },
  { name: "æµªæ¼«å¤å¨å¤·", price: 290 },
  { name: "æµ·é®®æ´¾å°", price: 300 },
  { name: "å·§é‡ä¸‰åŠå®¢", price: 300 },
  { name: "éŸ“å¼ç‡’è‚‰", price: 340 },
  { name: "æ·±å±±é‡è±¬", price: 340 },
  { name: "æ·±æµ·èŠ±æç‡’", price: 310 },
  { name: "çš‡å®¶æµ·é™¸å¤§é¤", price: 370 },
  { name: "è”¥è”¥é‡è¦‹ç‰›è‚‰", price: 370 },
  { name: "é†¬ç‡’è±¬è‚‰", price: 340 },
  { name: "ç¾©å¼è½Ÿç‚¸æ©Ÿ", price: 300 },
  { name: "åˆæˆ€çš„æ»‹å‘³", price: 280 },
  { name: "é‡è‡ç‡»è…¸", price: 280 },
  { name: "èœ‚èœœå·§å…‹åŠ›", price: 200 }
];

const order = [];

function renderMenu() {
  const container = document.getElementById('menu-list');
  menuItems.forEach((item, index) => {
    const el = document.createElement('div');
    el.className = 'item';
    el.innerHTML = `
      <strong>${item.name}</strong><br>
      åƒ¹æ ¼ï¼š${item.price} å…ƒ<br>
      <label><input type="checkbox" id="cheese-${index}"> èµ·å¸åŠ é‡ (+40)</label><br>
      <button onclick="addToOrder(${index})">åŠ å…¥</button>
    `;
    container.appendChild(el);
  });
}

function addToOrder(index) {
  const item = menuItems[index];
  const cheese = document.getElementById(`cheese-${index}`).checked;
  const name = item.name + (cheese ? 'ï¼ˆåŠ èµ·å¸ï¼‰' : '');
  const price = item.price + (cheese ? 40 : 0);
  order.push({ name, price });
  updateOrderList();
}

function updateOrderList() {
  const list = document.getElementById('order-items');
  list.innerHTML = '';
  let total = 0;
  order.forEach(item => {
    const li = document.createElement('li');
    li.textContent = `${item.name} - ${item.price} å…ƒ`;
    list.appendChild(li);
    total += item.price;
  });
  document.getElementById('total-price').textContent = total;
}

function submitOrder() {
  const phone = document.getElementById('customer-phone').value;
  if (!phone || order.length === 0) {
    alert("è«‹å¡«å¯«é›»è©±ä¸¦é¸æ“‡é¤é»ï¼");
    return;
  }

  const payload = {
    phone: phone,
    items: order
  };

  // POST to Flask backend
  fetch('/submit_order', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify(payload)
  })
  .then(res => res.json())
  .then(data => {
    alert("è¨‚å–®å·²é€å‡ºï¼è¨‚å–®ç·¨è™Ÿï¼š" + data.order_id);
    location.reload();
  });
}
renderMenu();
</script>
</body>
</html>
